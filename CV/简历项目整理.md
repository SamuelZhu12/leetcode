# 美赛项目

## 题目

亚马逊在网购平台提供了两种功能：评级/星级(rate)、评估/评论(review)。个人评级称为“产品星级评估（star rating）”，也就是客户买完产品后的评价，由1星到5星；另外，购买产品的客户还能评论，表达自己的意见和信息。而其他客户还可以对这些评论进行评级，称为“帮助性评级/评论星级评级（helpfulness rating）”。公司用这些数据去了解市场、了解市场参与时机、对产品的设计改造等。

阳光公司打算在网上市场推出“吹风机”、“婴儿奶嘴”、“微波炉”三款产品。他们希望得到以往客户对同类竞争产品的评价，例如：关键模式（数据库领域术语，可以理解为这些产品逻辑层面上的结构）、关系、度量/评估/判定（可以理解为“评价”一类的意思）、各类参数（原文：key patterns, relationships, measures, and parameters）。以便为他们做两件事：（1）确定在线销售策略，（2）分析产品的关键设计特征，以提高产品的竞争力。

该公司曾用过数据来指导销售，但未用过如此特殊的数据组合，所以他们对其中的“基于时间的模式（time-based patterns）”很感兴趣，也希望知道这种方法能否帮助他们成功塑造产品的可交互性。

亚马逊已在附件中为您提供了相应三款产品（奶嘴、吹风机、微波炉）的往期数据，其中包括客户信息、评级信息、评论等有用的信息。

## 数据集

●市场（字符串）：撰写评论的市场的2个字母的国家代码。

●customer_id（字符串）：随机标识符，可用于汇总单个作者撰写的评论。

●review_id（字符串）：评论的唯一ID。

●product_id（字符串）：审核所属的唯一产品ID。

●product_parent（字符串）：随机标识符，可用于汇总同一产品的评论。

●product_title（字符串）：产品的标题。

●product_category（字符串）：产品的主要消费者类别。

●star_rating（int）：评论的1-5星评级。

●helpful_votes（int）：有用的投票数。

●total_votes（int）：评论收到的总票数。

●vine（字符串）：基于客户在撰写准确而有见地的评论方面所获得的信任，邀请客户成为Amazon Vine Voices。亚马逊为Amazon Vine成员提供了供应商已提交给该程序的产品的免费副本。 Amazon不会影响Amazon Vine成员的意见，也不会修改或编辑评论。

●verify_purchase（字符串）：“ Y”表示亚马逊已验证撰写评论的人在亚马逊上购买了该产品，并且没有以大幅折扣收到该产品。

●review_headline（字符串）：评论的标题。

●review_body（字符串）：评论文本。

●review_date（bigint）：撰写评论的日期。

## 解题步骤

1. 数据可视化，如三种商品的评分、有用票数对比等

2. 建立评论价值模型，使用AHP层次分析法为每个维度确定权值（评论的长度、单词个数、消费者是否vine等），给出一个计算评论价值的标准，用该分值乘以star_ratings，得到实际评分。（评论的越好，实际rating就越可信）

3. 对star_rating和文本之间做相关系数分析，并且在star_rating中通过tf-idf去计算星级中的高频词作为商品特征。

   ![image-20220911200404140](https://typora-1308702321.cos.ap-guangzhou.myqcloud.com/img/image-20220911200404140.png)

# 长江证券实习项目

## 异常交易判别模型

### 业务逻辑

1. 根据上交所、深交所、证监会出台的异常交易行为判定文件，整理出符合异常交易的行为。比如同一时间多次买卖

## SparkStreaming + Kafka将日志写入Oracle

### 业务逻辑

1. 将数仓底层脱敏以后的交易数据写入Oracle数据库中
2. 对源数据进行轻度清洗，过滤空行，过滤账户id为空的客户
3. 对每日交易总额按账户进行轻度汇总
4. 按用户账号属性分别落表

### 配置架构

#### 集群端

1. 作为Kafka的broker供生产者发送数据到消息队列，在集群端配置好kafka集群并启动（需先开启zookeeper）
2. 选择一个节点搭建mysql数据库，作为最后数据入库的地方

#### IDE

1. 创建一个生产者类，读取txt文件，通过制表符分隔，发送到kafka集群
2. 创建一个消费者类，去消费kafka中的数据，编写计算流程，将数据保存至数据库
3. 本地测试的时候，`SparkConf中SetMaster("local")`，如果要打包放到集群中以spark on yarn或者spark stand-alone来运行，则是```SetMaster("Yarn")``` 和 ```SetMaster("Master")```
4. 生产环境下，生产者类发送消息是单独的定时任务去进行，而消费者类是另一个定时任务去定时消费队列中的数据，两者一般不在同一个程序中。

## 注意事项

1. MySQL和IDE的连接注意MySQL8.0的版本中，JDBC的连接URL需要加上统一时区等参数

```scala
  def mysqlConnection(): Connection = {
    Class.forName("com.mysql.cj.jdbc.Driver")
    DriverManager.getConnection("jdbc:mysql://localhost:3306/rng_comment?useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone = GMT", "root", "123456")
  }
```

2. 一定要配置好集群端的环境